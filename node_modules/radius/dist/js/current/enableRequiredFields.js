(function (global, factory) {
  if (typeof define === "function" && define.amd) {
    define('radius/enableRequiredFields', ['exports', './utils', 'lodash/forEach'], factory);
  } else if (typeof exports !== "undefined") {
    factory(exports, require('./utils'), require('lodash/forEach'));
  } else {
    var mod = {
      exports: {}
    };
    factory(mod.exports, global.utils, global.forEach);
    global.radiusEnableRequiredFields = mod.exports;
  }
})(this, function (exports, _utils, _forEach) {
  'use strict';

  Object.defineProperty(exports, "__esModule", {
    value: true
  });

  var _utils2 = _interopRequireDefault(_utils);

  var _forEach2 = _interopRequireDefault(_forEach);

  function _interopRequireDefault(obj) {
    return obj && obj.__esModule ? obj : {
      default: obj
    };
  }

  var FIELD_SELECTOR = 'data-required';

  exports['default'] = function () {
    _utils2['default'].addEventListener(document.body, 'focus', onFocus, true);
    _utils2['default'].addEventListener(document.body, 'submit', onSubmit, true);

    function onFocus(event) {
      var element = event.target;
      enableRequiredField(element);
    }

    function onSubmit(event) {
      var form = event.target;

      (0, _forEach2['default'])(form.querySelectorAll('[' + FIELD_SELECTOR + ']'), enableRequiredField);

      if (!form.checkValidity()) {
        event.preventDefault();
      }
    }

    function enableRequiredField(element) {
      if (!_utils2['default'].hasAttribute(element, FIELD_SELECTOR)) {
        return;
      }

      element.setAttribute('required', true);
      element.removeAttribute(FIELD_SELECTOR);
    }
  };
});